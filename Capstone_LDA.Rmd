---
title: "Capstone: LDA"
author: "Andrew Knittle"
date: "`r paste('Generated on', Sys.Date())`" 
output: 
  html_document: 
    # try readable or cosmo
    # default (default), try kable, tibble, or paged as an option
    # Options are none (default), show, and hide
    # default is null, try my_style_file.css
    toc: TRUE
    toc_depth: 3
    toc_float: FALSE
    highlight: haddock
    theme: flatly
    df_print: paged
    code_folding: none
    self_contained: TRUE
---

```{r setup, include=FALSE}
# --------------------------------------
# Clean and Prep Environment
rm(list=ls())
set.seed(123)

# --------------------------------------
# Load Libraries
library(pacman)
p_load(ggplot2)
p_load(ISLR)
p_load(dplyr)
p_load(psych)
p_load(ggpubr)
p_load(kableExtra)
p_load(corrplot)
p_load(tidyverse)
p_load(caret)
p_load(MASS)
p_load(glm.predict)
p_load(glmnet)
p_load(boot)

# --------------------------------------
# Read Data
setwd(dirname(rstudioapi::getSourceEditorContext()$path))
logDustData = as.data.frame(read.csv('Data/logDustData_Reduced.csv',header=T,sep=','))
logDustData <- logDustData[-1]
logDustData <- logDustData[-1]
logDustData$CASESTAT <- as.factor(logDustData$CASESTAT)
logDustData <- na.omit(logDustData[,c(1:27, 30)])

# train_DustData <- as.data.frame(read.csv('Data/Training Set_0.9_May 25 2021.csv',header=T,sep=','))[-1]
# train_DustData$CASESTAT <- as.numeric(train_DustData$CASESTAT)
# train_DustData <- na.omit(train_DustData[,c(1:27, 30)])

# --------------------------------------
# Read helper script
source("Exploratory_Support_Scripts.R")
source("Script_Library.R")
source("CrossValidation_Library.R")
source("Model_Building_Library.R")



```




```{r Model Building, echo=FALSE, fig.cap= "Model Building", out.height="100%", out.width="100%", warning=FALSE, comment=FALSE, warning=FALSE}


# Reattempting with my swiss army cross validator and with the full log data set
lda.formula <- formula(CASESTAT ~ .)
lda.fit <- lda(lda.formula, data = logDustData)
ldaCross <- crossValidator.byKPercent(df = logDustData, response = "CASESTAT", formula = lda.formula, family="lda")


# Print results of LDA
# ldaCross
errorsDF <- ldaCross[[1]]
crossError(errorsDF)
validCross <- ldaCross[[4]]
rawConfusionBuilder(validCross$Response, validCross$holdout.rawPredict)


```


# Conclusion

```{r Final Model, echo=FALSE, fig.cap= "Final Model", out.height="100%", out.width="100%", warning=FALSE, comment=FALSE, warning=FALSE}


lda.fit

# ----------------------------------------
rocFull <- rocBuilder(validCross$Response, validCross$holdout.rawPredict, toleranceVec = seq(0,1,0.001))
rocFull[[2]]
rocDF <- rocFull[[1]]
simpleAUC(rocDF$`True Positive Rate`, rocDF$`False Positive Rate`)

```

## Method

Linear Discriminatory Analysis (LDA) focuses on maximizing the separability among known categories, in this case it's positive and negative cancer results. This is done via a "cut", or plain, to create the separation. It functions similarly to Principle Component Analysis (PCA).

An important feature about LDA is that it only works on continuous independent variables, so this is perfect for the amount of chemicals detected as they are numerical continuous features. These variables are used to find the best linear combination of them to help best distinguish data across two or more groups. However, LDA is normally used when working with more than 2 classes, or factors.


